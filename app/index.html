<!-- 'http://api.forecast.io/forecast/f71f75cd9e99dbc211c6e48ceaae557c/47.705936,-122.320500?callback=?'
 -->
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="stylesheet.css">
<title> WEATHERVIZ BETA </title>
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="libs/Three.min.js"></script>
<script src="libs/ShaderParticles.min.js"></script>
<script src="libs/dat.gui.min.js"></script>
<script src="libs/helvetiker_regular.typeface.js"></script>
<script src="js/sheets.js"></script>
</head>

<body>


<form id="zipcode_form" class="form">
<label for="zipcode">zipcode</label>
<input type="text" id="zipcode" class="blinker" style="width: 100px;">
</form>

<div id="threeJSContainer"> </div>

<script>

//create weathersheets
var sheets = {
  day : [],
  text : [],
  pt : [],
  weatherType : [],
  weatherAudio: [],
  weatherGfx: [],

};

  //get literal description of forecast
  //  add days of the week
  // add type of weather
  // add audio
  function makeSheets(data) {
    for (var i = 0; i < data['forecast']['txt_forecast']
    ['forecastday'].length; i+=2 ) {
        sheets.text.push(data['forecast']['txt_forecast']['forecastday'][i]['fcttext']);
        sheets.day.push(data['forecast']['txt_forecast']['forecastday'][i]['title']);
        sheets.weatherType.push(data['forecast']['txt_forecast']['forecastday'][i]['icon']);
    }


    for (var i = 0; i < sheets.weatherType.length; i++ ) {

         if (sheets.weatherType[i] == "chanceflurries") {
            sheets.weatherAudio[i] = "snow.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "chancerain") {
            sheets.weatherAudio[i] = "heavyRain.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "chancesleet") {
            sheets.weatherAudio[i] = "snow.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "chancesnow") {
            sheets.weatherAudio[i] = "snow.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "chancetstorms") {
            sheets.weatherAudio[i] = "thunderstorm.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "clear") {
            sheets.weatherAudio[i] = "clear.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "cloudy") {
            sheets.weatherAudio[i] = "clear.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] == "flurries") {
            sheets.weatherAudio[i] = "snow.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "drizzle") {
            sheets.weatherAudio[i] = "drizzle.mp3";
            console.log(sheets.weatherAudio[i]);


        } else if (sheets.weatherType[i] === "fog") {
            sheets.weatherAudio[i] = "clear.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "hazy") {
            sheets.weatherAudio[i] = "clear.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "mostlycloudy") {
          sheets.weatherAudio[i] = "clear.mp3";
          console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "mostlysunny") {
          sheets.weatherAudio[i] = "clear.mp3";
          console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "partlycloudy") {
          sheets.weatherAudio[i] = "clear.mp3";
          console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "partlysunny") {
          sheets.weatherAudio[i] = "clear.mp3";
          console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "sleet") {
            sheets.weatherAudio[i] = "snow.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "rain") {
            sheets.weatherAudio[i] = "heavyRain.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "snow") {
            sheets.weatherAudio[i] = "snow.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "sunny") {
            sheets.weatherAudio[i] = "clear.mp3";
            console.log(sheets.weatherAudio[i]);

        } else if (sheets.weatherType[i] === "tstorms") {
            sheets.weatherAudio[i] = "thunderstorm.mp3";
            console.log(sheets.weatherAudio[i]);

        } else {
          sheets.weatherAudio[i] = "No matching weather pattern at" + [i];
          console.log(sheets.weatherAudio[i]);
        }

    }
    console.log(sheets);
  }

//on startup
$(function() {
//threeJS setup

$("#zipcode").focus();

var weatherObj;

//hide this somewhere!
var apiKey = "f71f75cd9e99dbc211c6e48ceaae557c";

// //get forecast based on user ZIP

$('#zipcode_form').submit(function(e) {
  e.preventDefault();

  var zip = $('#zipcode').val();
  if (zip !== "demo") {
  // toggleFullScreen();
  $.getJSON('https://api.wunderground.com/api/19e8ddc94141aec0/forecast/q/'
   + zip + '.json', function(data){

  //Make the sheets
  makeSheets(data);

  // //fade in+out
  $('#zipcode_form').hide();


  setTimeout(function(){
  init();
  render();
  $('#threeJSContainer').fadeIn(2000);
  }, 2000);
  });

   } else {
   //set full screen
  // toggleFullScreen();
  $.getJSON('demo.json', function(data){

  //Make the sheets
  makeSheets(data);

  // //fade in+out
  $('#zipcode_form').hide();



  setTimeout(function(){
  init();
  render();
  $('#threeJSContainer').fadeIn(2000);
  }, 2000);
  });
  }

  });
});
</script>
</body>
</html>
